<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>sample</title>
<meta content="" name="description">
<meta content="" name="keywords">



<!-- Favicons -->
<link href="#" rel="icon">
<link href="#" rel="apple-touch-icon">

<!-- Google Fonts -->
<link href="https://fonts.gstatic.com" rel="preconnect">
<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
	rel="stylesheet">

<!-- Vendor CSS Files -->

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
	crossorigin="anonymous">


<link
	href="${pageContext.request.contextPath}/resources/assets/vendor/bootstrap-icons/bootstrap-icons.css"
	rel="stylesheet">


<!-- Template Main CSS File -->
<link
	href="${pageContext.request.contextPath}/resources/css/main_css/main.css"
	rel="stylesheet">

<script
	src="${pageContext.request.contextPath}/resources/js/httpRequest.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
	
	window.onload = function(){
		let idx='<%=request.getParameter("idx")%>
	';
		document.ff.idx.value = idx;
		var url = 'buy_product.do';
		var param = 'idx=' + idx;
		sendRequest(url, param, resFn, "POST")
	}
	let price;
	function resFn() {
		if (xhr.readyState == 4 && xhr.status == 200) {
			price = parseInt(xhr.responseText);

			document.ff.totPrice.innerHTML = price + 3000;
		}
	}

	function amount_pm(op) {
		const f = document.ff;
		const amount = parseInt(f.amount.value);
		let totPrice = parseInt(f.totPrice.innerHTML);
		
		if (op == '+') {
			f.amount.value = amount + 1;
			totPrice += price;
		} else if (op == '-' && amount > 1) {
			f.amount.value = amount - 1;
			totPrice -= price;
		}
		document.getElementById("amount").innerHTML=amount;
		f.totPrice.innerHTML = totPrice;
	}
	function cart(f) {
		f.action = "cartAdd.do";
		f.price.value = f.totPrice.innerHTML;
		f.submit();

	}
</script>
<script>
	
</script>
</head>
<body>
	<%-- <jsp:include page="buy.jsp?idx='상품일련번호'"></jsp:include> --%>
	<form name="ff" class="card">
		<input name="idx" type="hidden"> 
		<input name="price" type="hidden">
		<input name="amount" type="hidden" value="1">
		<div style="width: 100%;">
			<div style="font-weight: bold; margin: 20px 0;">수량</div>
			<div class="input_number" style="width: 100%;">
				<div class="btn-group" role="group" aria-label="Basic example"
					style="width: 100%;">
					<button type="button" class="btn btn-primary left"
						onclick="cal('-');">-</button>
					<span class="btn btn-primary center" id="center">1</span>
					<button type="button" class="btn btn-primary right"
						onclick="cal('+');">+</button>
				</div>
			</div>
		</div>
		<div style="width: 100%;">
			<div style="font-weight: bold; margin: 20px 0;">총 가격</div>
			<div class="number" id="totPrice"></div>
		</div>
		<div class="shopping_basket">
			<button type="button" class="btn btn-primary number buy"
				onclick="cart(this.form);">
				<i class='bx bx-basket'>장바구니</i>
			</button>
		</div>
		<div class="shopping">
			<button type="button" class="btn btn-primary number buy"
				onclick="shopping('vo1.product_idx')">
				<i class='bx bx-gift'>구매하기</i>
			</button>
		</div>
	</form>


	<script
		src="${pageContext.request.contextPath}/resources/js/register/mainjs.js"></script>
	<!-- Vendor JS Files -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
		crossorigin="anonymous"></script>
	<script
		src="${pageContext.request.contextPath}/resources/js/main_js/main.js"></script>
</body>
</html>